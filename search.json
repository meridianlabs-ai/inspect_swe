[
  {
    "objectID": "codex_cli.html",
    "href": "codex_cli.html",
    "title": "Codex CLI",
    "section": "",
    "text": "The codex_cli() agent uses the unattended mode of OpenAI Codex CLI to execute agentic tasks within the Inspect sandbox. Model API calls that occur in the sandbox are proxied back to Inspect for handling by the model provider for the current task.\n\n\n\n\n\n\nNoteCodex CLI Installation\n\n\n\nBy default, the agent will download the current stable version of Codex CLI and copy it to the sandbox. You can also exercise more explicit control over which version of Codex CLI is used—see the Installation section below for details.",
    "crumbs": [
      "Home",
      "Agents",
      "Codex CLI"
    ]
  },
  {
    "objectID": "codex_cli.html#overview",
    "href": "codex_cli.html#overview",
    "title": "Codex CLI",
    "section": "",
    "text": "The codex_cli() agent uses the unattended mode of OpenAI Codex CLI to execute agentic tasks within the Inspect sandbox. Model API calls that occur in the sandbox are proxied back to Inspect for handling by the model provider for the current task.\n\n\n\n\n\n\nNoteCodex CLI Installation\n\n\n\nBy default, the agent will download the current stable version of Codex CLI and copy it to the sandbox. You can also exercise more explicit control over which version of Codex CLI is used—see the Installation section below for details.",
    "crumbs": [
      "Home",
      "Agents",
      "Codex CLI"
    ]
  },
  {
    "objectID": "codex_cli.html#basic-usage",
    "href": "codex_cli.html#basic-usage",
    "title": "Codex CLI",
    "section": "Basic Usage",
    "text": "Basic Usage\nUse the codex_cli() agent as you would any Inspect agent. For example, here we use it as the solver in an Inspect task:\nfrom inspect_ai import Task, task\nfrom inspect_ai.dataset import json_dataset\nfrom inspect_ai.scorer import model_graded_qa\n\nfrom inspect_swe import codex_cli\n\n@task\ndef system_explorer() -&gt; Task:\n    return Task(\n        dataset=json_dataset(\"dataset.json\"),\n        solver=codex_cli(),\n        scorer=model_graded_qa(),\n        sandbox=\"docker\",\n    )\nYou can also pass the agent as a --solver on the command line:\ninspect eval ctf.py --solver inspect_swe/codex_cli\nIf you want to try this out locally, see the system_explorer example.",
    "crumbs": [
      "Home",
      "Agents",
      "Codex CLI"
    ]
  },
  {
    "objectID": "codex_cli.html#options",
    "href": "codex_cli.html#options",
    "title": "Codex CLI",
    "section": "Options",
    "text": "Options\nThe following options are supported for customizing the behavior of the agent:\n\n\n\n\n\n\n\nOption\nDescription\n\n\n\n\nsystem_prompt\nAdditional system prompt to append to default system prompt.\n\n\nmodel_config\nModel configuration profile (e.g. used to determine the system prompt). Defaults to gpt-5-codex.\n\n\nskills\nAdditional skills to make available to the agent.\n\n\nmcp_servers\nMCP servers (see MCP Servers below for details).\n\n\nbridged_tools\nHost-side Inspect tools to expose via MCP (see Bridged Tools below for details).\n\n\ndisallowed_tools\nOptionally disallow tools (e.g. \"web_search\")\n\n\ncentaur\nRun in Centaur Mode, which makes Codex CLI available to an Inspect human_cli() agent rather than running it unattended.\n\n\nattempts\nAllow the agent to have multiple scored attempts at solving the task.\n\n\nmodel\nModel name to use for agent (defaults to main model for task).\n\n\nfilter\nFilter for intercepting bridged model requests.\n\n\nretry_refusals\nShould refusals be retried? (pass number of times to retry)\n\n\nhome_dir\nHome directory to use for codex cli. When set, AGENTS.md and the MCP configuration will be written here rather than to .codex\n\n\ncwd\nWorking directory for Codex CLI session.\n\n\nenv\nEnvironment variables to set for Codex CLI.\n\n\nversion\nVersion of Codex CLI to use (see Installation below for details)\n\n\n\nFor example, here we specify a custom system prompt and disallow the web_search tool:\ncodex_cli(\n    system_prompt=\"You are an ace system researcher.\",\n    disallowed_tools=[\"web_search\"]\n)",
    "crumbs": [
      "Home",
      "Agents",
      "Codex CLI"
    ]
  },
  {
    "objectID": "codex_cli.html#mcp-servers",
    "href": "codex_cli.html#mcp-servers",
    "title": "Codex CLI",
    "section": "MCP Servers",
    "text": "MCP Servers\nYou can specify one or more Model Context Protocol (MCP) servers to provide additional tools to Codex CLI. Servers are specified via the MCPServerConfig class and its Stdio and HTTP variants.\nFor example, here is a Dockerfile that makes the server-memory MCP server available in the sandbox container:\nFROM python:3.12-bookworm\n\n# nodejs (required by mcp server)\nRUN apt-get update && apt-get install -y --no-install-recommends \\\n    curl \\\n    && curl -fsSL https://deb.nodesource.com/setup_22.x | bash - \\\n    && apt-get install -y --no-install-recommends nodejs \\\n    && apt-get clean \\\n    && rm -rf /var/lib/apt/lists/*\n\n# memory mcp server\nRUN npx --yes @modelcontextprotocol/server-memory --version\n\n# run forever\nCMD [\"tail\", \"-f\", \"/dev/null\"]\nNote that we run the npx server during the build of the Dockerfile so that it is cached for use offline (below we’ll run it with the --offline option).\nWe can then use this MCP server in a task as follows:\nfrom inspect_ai import Task, task\nfrom inspect_ai.dataset import Sample\nfrom inspect_ai.tool import MCPServerConfigStdio\nfrom inspect_swe import codex_cli\n\n@task\ndef investigator() -&gt; Task:\n    return Task(\n        dataset=[\n            Sample(\n                input=\"What transport protocols are supported in \"\n                + \" the 2025-03-26 version of the MCP spec?\"\n            )\n        ],\n        solver=codex_cli(\n            system_prompt=\"Please use the web search tool to \"\n            + \"research this question and the memory tools \"\n            + \"to keep track of your research.\",\n            mcp_servers=[\n                MCPServerConfigStdio(\n                    name=\"memory\",\n                    command=\"npx\",\n                    args=[\n                        \"--offline\",\n                        \"@modelcontextprotocol/server-memory\"\n                    ],\n                )\n            ]\n        ),\n        sandbox=(\"docker\", \"Dockerfile\"),\n    )\nNote that we run the MCP server using the --offline option so that it doesn’t require an internet connection (which it would normally use to check for updates to the package).",
    "crumbs": [
      "Home",
      "Agents",
      "Codex CLI"
    ]
  },
  {
    "objectID": "codex_cli.html#bridged-tools",
    "href": "codex_cli.html#bridged-tools",
    "title": "Codex CLI",
    "section": "Bridged Tools",
    "text": "Bridged Tools\nYou can expose host-side Inspect tools to the sandboxed agent via the MCP protocol using the bridged_tools parameter. This allows you to run tools on the host (e.g. tools that access host resources, databases, or APIs) but make them available to the agent running inside the sandbox.\nTools are specified via BridgedToolsSpec which wraps a list of Inspect tools:\nfrom inspect_ai import Task, task\nfrom inspect_ai.agent import BridgedToolsSpec\nfrom inspect_ai.dataset import Sample\nfrom inspect_ai.tool import tool\nfrom inspect_swe import codex_cli\n\n@tool\ndef search_database():\n    async def execute(query: str) -&gt; str:\n        \"\"\"Search the internal database.\n\n        Args:\n            query: The search query.\n        \"\"\"\n        # This runs on the host, not in the sandbox\n        return f\"Results for: {query}\"\n    return execute\n\n@task\ndef investigator() -&gt; Task:\n    return Task(\n        dataset=[\n            Sample(input=\"Search for information about MCP protocols.\")\n        ],\n        solver=codex_cli(\n            system_prompt=\"Use the search tool to research.\",\n            bridged_tools=[\n                BridgedToolsSpec(\n                    name=\"host_tools\",\n                    tools=[search_database()]\n                )\n            ]\n        ),\n        sandbox=(\"docker\", \"Dockerfile\"),\n    )\nThe name field identifies the MCP server and will be visible to the agent as a tool prefix. You can specify multiple BridgedToolsSpec instances to create separate MCP servers for different tool groups.\nSee the Bridged Tools documentation for more details on the architecture and how tool execution flows between host and sandbox.",
    "crumbs": [
      "Home",
      "Agents",
      "Codex CLI"
    ]
  },
  {
    "objectID": "codex_cli.html#installation-1",
    "href": "codex_cli.html#installation-1",
    "title": "Codex CLI",
    "section": "Installation",
    "text": "Installation\nBy default, the agent will download the current stable version of Codex CLI and copy it to the sandbox. You can override this behaviour using the version option:\n\n\n\n\n\n\n\nOption\nDescription\n\n\n\n\n\"auto\"\nUse any available version of Codex CLI in the sandbox, otherwise download the latest version.\n\n\n\"sandbox\"\nUse the version of Codex CLI in the sandbox (raises RuntimeError if not available in the sandbox)\n\n\n\"latest\"\nDownload and use the very latest version.\n\n\n\"x.x.x\"\nDownload and use a specific version number.\n\n\n\nIf you don’t ever want to rely on automatic downloads of Codex CLI (e.g. if you run your evaluations offline), you can use one of two approaches:\n\nPre-install the version of Codex CLI you want to use in the sandbox, then use version=\"sandbox\":\ncodex_cli(version=\"sandbox\")\nDownload the version of Codex CLI you want to use into the cache, then specify that version explicitly:\n# download the agent binary during installation/configuration\ndownload_agent_binary(\"codex_cli\", \"0.29.0\", \"linux-x64\")\n\n# reference that version in your task (no download will occur)\ncodex_cli(version=\"0.29.0\")\nNote that the 5 most recently downloaded versions are retained in the cache. Use the cached_agent_binaries() function to list the contents of the cache.",
    "crumbs": [
      "Home",
      "Agents",
      "Codex CLI"
    ]
  },
  {
    "objectID": "codex_cli.html#centaur-mode",
    "href": "codex_cli.html#centaur-mode",
    "title": "Codex CLI",
    "section": "Centaur Mode",
    "text": "Centaur Mode\nThe codex_cli() agent can also be run in “centaur” mode which uses the Inspect AI Human Agent as the solver and makes Codex CLI available to the human user for help with the task. So rather than strictly measuring human vs. model performance, you are able to measure performance of humans working collaboratively with a model.\nEnable centaur mode by passing centaur=True to the codex_cli() agent:\nfrom inspect_ai import Task, task\nfrom inspect_ai.dataset import json_dataset\nfrom inspect_ai.scorer import model_graded_qa\n\nfrom inspect_swe import codex_cli\n\n@task\ndef system_explorer() -&gt; Task:\n    return Task(\n        dataset=json_dataset(\"dataset.json\"),\n        solver=codex_cli(centaur=True),\n        scorer=model_graded_qa(),\n        sandbox=\"docker\",\n    )\nYou can also enable centaur mode from the CLI using a solver arg (-S):\ninspect eval ctf.py --solver inspect_swe/codex_cli -S centaur=true\nYou can also pass CentaurOptions to further customize the behavior of the human agent. For example:\nfrom inspect_swe import CentaurOptions\n\nTask(\n    dataset=json_dataset(\"dataset.json\"),\n    solver=codex_cli(centaur=CentaurOptions(answer=False)),\n    scorer=model_graded_qa(),\n    sandbox=\"docker\",\n)\nSee the human_cli() documentation for details on available options.",
    "crumbs": [
      "Home",
      "Agents",
      "Codex CLI"
    ]
  },
  {
    "objectID": "codex_cli.html#troubleshooting",
    "href": "codex_cli.html#troubleshooting",
    "title": "Codex CLI",
    "section": "Troubleshooting",
    "text": "Troubleshooting\nIf Codex CLI doesn’t appear to be working or working as expected, you can troubleshoot by dumping the Codex CLI debug log after an evaluation task is complete. You can do this with:\ninspect trace dump --filter \"Codex CLI\"",
    "crumbs": [
      "Home",
      "Agents",
      "Codex CLI"
    ]
  },
  {
    "objectID": "CHANGELOG.html",
    "href": "CHANGELOG.html",
    "title": "Inspect SWE",
    "section": "",
    "text": "Agent execution: Redirect stdin using exec 0&lt;/dev/null;\nAgent execution: Print returncode for failed processes."
  },
  {
    "objectID": "CHANGELOG.html#february-2026",
    "href": "CHANGELOG.html#february-2026",
    "title": "Inspect SWE",
    "section": "",
    "text": "Agent execution: Redirect stdin using exec 0&lt;/dev/null;\nAgent execution: Print returncode for failed processes."
  },
  {
    "objectID": "CHANGELOG.html#february-2026-1",
    "href": "CHANGELOG.html#february-2026-1",
    "title": "Inspect SWE",
    "section": "0.2.33 (10 February 2026)",
    "text": "0.2.33 (10 February 2026)\n\nClaude Code: Look for request timeout errors in stdout as well as stderr.\nClaude Code: Restore default “auto” version behavior (download latest stable version)."
  },
  {
    "objectID": "CHANGELOG.html#january-2026",
    "href": "CHANGELOG.html#january-2026",
    "title": "Inspect SWE",
    "section": "0.2.32 (31 January 2026)",
    "text": "0.2.32 (31 January 2026)\n\nClaude Code: Set “auto” version to 2.1.3 (which avoids a not yet fixed compaction bug with gateways).\nClaude Code: Add retry_timeouts option for retrying “Request timed out” errors a configurable number of times.\nClaude Code: Add CLAUDE_CODE_DISABLE_EXPERIMENTAL_BETAS environment variable."
  },
  {
    "objectID": "CHANGELOG.html#january-2026-1",
    "href": "CHANGELOG.html#january-2026-1",
    "title": "Inspect SWE",
    "section": "0.2.31 (03 January 2026)",
    "text": "0.2.31 (03 January 2026)\n\nCentaur Mode for running Claude Code and Codex CLI alongside the Inspect Human Agent.\nUpdate Inspect dependency to 0.3.159 (required for human agent integration)."
  },
  {
    "objectID": "CHANGELOG.html#december-2025",
    "href": "CHANGELOG.html#december-2025",
    "title": "Inspect SWE",
    "section": "0.2.30 (24 December 2025)",
    "text": "0.2.30 (24 December 2025)\n\nAgent Skills: Support for adding skills to Claude Code and Codex CLI agents.\nUpdate Inspect dependency to 0.3.158 (required for skills implementation)."
  },
  {
    "objectID": "CHANGELOG.html#december-2025-1",
    "href": "CHANGELOG.html#december-2025-1",
    "title": "Inspect SWE",
    "section": "0.2.29 (22 December 2025)",
    "text": "0.2.29 (22 December 2025)\n\nClaude Code: Enable explicit specification of opus_model, sonnet_model, haiku_model, and subagent_model.\nUpdate Inspect dependency to 0.3.157 (required for changes to codex cli web search)."
  },
  {
    "objectID": "CHANGELOG.html#december-2025-2",
    "href": "CHANGELOG.html#december-2025-2",
    "title": "Inspect SWE",
    "section": "0.2.28 (05 December 2025)",
    "text": "0.2.28 (05 December 2025)\n\nCodex CLI and Claude Code: Added bridged_tools parameter for exposing host-side Inspect tools to sandboxed agents via MCP protocol.\nCodex CLI: Use GPT 5.1 system prompt by default (includes guidance on using the update_plan() tool which is excluded from gpt-5-codex system prompt).\nCodex CLI: Add config_overrides parameter for overriding arbitrary config values.\nUpdate Inspect dependency to 0.3.152 (required for bridged tools)."
  },
  {
    "objectID": "CHANGELOG.html#november-2025",
    "href": "CHANGELOG.html#november-2025",
    "title": "Inspect SWE",
    "section": "0.2.27 (27 November 2025)",
    "text": "0.2.27 (27 November 2025)\n\nCodex CLI: Use RUST_LOG=warning (rather than debug) to reduce amount of output produced by exec().\nCodex CLI: Enable setting a custom home_dir (override default of ~).\nHandle multiple run() calls to the same agent (resume session and send only new messages in prompt)."
  },
  {
    "objectID": "CHANGELOG.html#november-2025-1",
    "href": "CHANGELOG.html#november-2025-1",
    "title": "Inspect SWE",
    "section": "0.2.26 (15 November 2025)",
    "text": "0.2.26 (15 November 2025)\n\nCopy agent binary executables to /var/tmp/ (more liberal default permissions)\nAgent binary chmod+x using “root” user for scenarios where they agent isn’t root."
  },
  {
    "objectID": "CHANGELOG.html#november-2025-2",
    "href": "CHANGELOG.html#november-2025-2",
    "title": "Inspect SWE",
    "section": "0.2.25 (07 November 2025)",
    "text": "0.2.25 (07 November 2025)\n\nCodex CLI: Execute codex using the user passed to codex_cli()."
  },
  {
    "objectID": "CHANGELOG.html#november-2025-3",
    "href": "CHANGELOG.html#november-2025-3",
    "title": "Inspect SWE",
    "section": "0.2.24 (01 November 2025)",
    "text": "0.2.24 (01 November 2025)\n\nClaude Code: Pass model through to agent bridge to accomodate scenarios where a non-Inspect model is specified.\nClaude Code: Remove small_model setting as it conflicts with aforementioned fix to non-Inspect model."
  },
  {
    "objectID": "CHANGELOG.html#october-2025",
    "href": "CHANGELOG.html#october-2025",
    "title": "Inspect SWE",
    "section": "0.2.23 (27 October 2025)",
    "text": "0.2.23 (27 October 2025)\n\nCodex: Eliminate use of --include-plan-tool option (no longer available as plan mode is now always on)."
  },
  {
    "objectID": "CHANGELOG.html#october-2025-1",
    "href": "CHANGELOG.html#october-2025-1",
    "title": "Inspect SWE",
    "section": "0.2.22 (16 October 2025)",
    "text": "0.2.22 (16 October 2025)\n\nCodex CLI now uses the latest version of codex, which includes the apply_patch tool.\nUpdate inspect_ai requirement to &gt;= 0.3.138."
  },
  {
    "objectID": "CHANGELOG.html#october-2025-2",
    "href": "CHANGELOG.html#october-2025-2",
    "title": "Inspect SWE",
    "section": "0.2.20 (07 October 2025)",
    "text": "0.2.20 (07 October 2025)\n\nCodex CLI now uses 0.44.0 as its default version (since later versions include the apply_patch tool which relies on “custom” tool types not currently supported by Inspect)."
  },
  {
    "objectID": "CHANGELOG.html#october-2025-3",
    "href": "CHANGELOG.html#october-2025-3",
    "title": "Inspect SWE",
    "section": "0.2.19 (05 October 2025)",
    "text": "0.2.19 (05 October 2025)\n\nAutomatically use a new port for each unique agent bridge invocation within a sample.\nAdded cached_agent_binaries() function to list previously downloaded and cached agent binaries."
  },
  {
    "objectID": "CHANGELOG.html#september-2025",
    "href": "CHANGELOG.html#september-2025",
    "title": "Inspect SWE",
    "section": "0.2.18 (23 September 2025)",
    "text": "0.2.18 (23 September 2025)\n\nUpdate for Claude Code 2.0 (don’t call config list after installation as it has been removed).\nUpdate inspect_ai requirement to &gt;= 0.3.135."
  },
  {
    "objectID": "CHANGELOG.html#september-2025-1",
    "href": "CHANGELOG.html#september-2025-1",
    "title": "Inspect SWE",
    "section": "0.2.17 (23 September 2025)",
    "text": "0.2.17 (23 September 2025)\n\nUpdate inspect_ai requirement to &gt;=0.3.134."
  },
  {
    "objectID": "CHANGELOG.html#september-2025-2",
    "href": "CHANGELOG.html#september-2025-2",
    "title": "Inspect SWE",
    "section": "0.2.16 (23 September 2025)",
    "text": "0.2.16 (23 September 2025)\n\nAdd support for the update_plan() tool for Codex CLI."
  },
  {
    "objectID": "CHANGELOG.html#september-2025-3",
    "href": "CHANGELOG.html#september-2025-3",
    "title": "Inspect SWE",
    "section": "0.2.15 (23 September 2025)",
    "text": "0.2.15 (23 September 2025)\n\nUse gpt-5-codex as the default model config for Codex CLI (e.g. results in use of the gpt-5-codex specific system instructions)."
  },
  {
    "objectID": "CHANGELOG.html#september-2025-4",
    "href": "CHANGELOG.html#september-2025-4",
    "title": "Inspect SWE",
    "section": "0.2.14 (22 September 2025)",
    "text": "0.2.14 (22 September 2025)\n\nSupport multiple attempts for Codex CLI via codex exec &lt;...&gt; resume --last (requires Codex v0.36.0 or later).\nAdd retry_refusals option to set a configurable number of retries for requests refused due to content filtering.\nUpdate inspect_ai requirement to &gt;=0.3.133."
  },
  {
    "objectID": "CHANGELOG.html#september-2025-5",
    "href": "CHANGELOG.html#september-2025-5",
    "title": "Inspect SWE",
    "section": "0.2.13 (12 September 2025)",
    "text": "0.2.13 (12 September 2025)\n\nUpdate inspect_ai requirement to &gt;=0.3.132."
  },
  {
    "objectID": "CHANGELOG.html#september-2025-6",
    "href": "CHANGELOG.html#september-2025-6",
    "title": "Inspect SWE",
    "section": "0.2.12 (08 September 2025)",
    "text": "0.2.12 (08 September 2025)\n\nClose stdin when running agent binaries (needed for k8s provider to work properly)"
  },
  {
    "objectID": "CHANGELOG.html#september-2025-7",
    "href": "CHANGELOG.html#september-2025-7",
    "title": "Inspect SWE",
    "section": "0.2.11 (06 September 2025)",
    "text": "0.2.11 (06 September 2025)\n\nCodex CLI: New codex_cli() agent for OpenAI Codex.\nAdded filter parameter to agents for intercepting model generations."
  },
  {
    "objectID": "CHANGELOG.html#september-2025-8",
    "href": "CHANGELOG.html#september-2025-8",
    "title": "Inspect SWE",
    "section": "0.2.10 (03 September 2025)",
    "text": "0.2.10 (03 September 2025)\n\nAdd trace logging for claude code debug/verbose output."
  },
  {
    "objectID": "CHANGELOG.html#v0.2.8-02-september-2025",
    "href": "CHANGELOG.html#v0.2.8-02-september-2025",
    "title": "Inspect SWE",
    "section": "v0.2.8 (02 September 2025)",
    "text": "v0.2.8 (02 September 2025)\n\nClaude Code: allowed_tools and disallowed_tools options."
  },
  {
    "objectID": "CHANGELOG.html#v0.2.6-01-september-2025",
    "href": "CHANGELOG.html#v0.2.6-01-september-2025",
    "title": "Inspect SWE",
    "section": "v0.2.6 (01 September 2025)",
    "text": "v0.2.6 (01 September 2025)\n\nClaude Code: Add support for multiple agent attempts."
  },
  {
    "objectID": "CHANGELOG.html#v0.2.5-01-september-2025",
    "href": "CHANGELOG.html#v0.2.5-01-september-2025",
    "title": "Inspect SWE",
    "section": "v0.2.5 (01 September 2025)",
    "text": "v0.2.5 (01 September 2025)\nInitial release."
  },
  {
    "objectID": "claude_code.html",
    "href": "claude_code.html",
    "title": "Claude Code",
    "section": "",
    "text": "The claude_code() agent uses the unattended mode of Anthropic Claude Code to execute agentic tasks within the Inspect sandbox. Model API calls that occur in the sandbox are proxied back to Inspect for handling by the model provider for the current task.\n\n\n\n\n\n\nNoteClaude Code Installation\n\n\n\nBy default, the agent will download the current stable version of Claude Code and copy it to the sandbox. You can also exercise more explicit control over which version of Claude Code is used—see the Installation section below for details.",
    "crumbs": [
      "Home",
      "Agents",
      "Claude Code"
    ]
  },
  {
    "objectID": "claude_code.html#overview",
    "href": "claude_code.html#overview",
    "title": "Claude Code",
    "section": "",
    "text": "The claude_code() agent uses the unattended mode of Anthropic Claude Code to execute agentic tasks within the Inspect sandbox. Model API calls that occur in the sandbox are proxied back to Inspect for handling by the model provider for the current task.\n\n\n\n\n\n\nNoteClaude Code Installation\n\n\n\nBy default, the agent will download the current stable version of Claude Code and copy it to the sandbox. You can also exercise more explicit control over which version of Claude Code is used—see the Installation section below for details.",
    "crumbs": [
      "Home",
      "Agents",
      "Claude Code"
    ]
  },
  {
    "objectID": "claude_code.html#basic-usage",
    "href": "claude_code.html#basic-usage",
    "title": "Claude Code",
    "section": "Basic Usage",
    "text": "Basic Usage\nUse the claude_code() agent as you would any Inspect agent. For example, here we use it as the solver in an Inspect task:\nfrom inspect_ai import Task, task\nfrom inspect_ai.dataset import json_dataset\nfrom inspect_ai.scorer import model_graded_qa\n\nfrom inspect_swe import claude_code\n\n@task\ndef system_explorer() -&gt; Task:\n    return Task(\n        dataset=json_dataset(\"dataset.json\"),\n        solver=claude_code(),\n        scorer=model_graded_qa(),\n        sandbox=\"docker\",\n    )\nYou can also pass the agent as a --solver on the command line:\ninspect eval ctf.py --solver inspect_swe/claude_code\nIf you want to try this out locally, see the system_explorer example.",
    "crumbs": [
      "Home",
      "Agents",
      "Claude Code"
    ]
  },
  {
    "objectID": "claude_code.html#options",
    "href": "claude_code.html#options",
    "title": "Claude Code",
    "section": "Options",
    "text": "Options\nThe following options are supported for customizing the behavior of the agent:\n\n\n\n\n\n\n\nOption\nDescription\n\n\n\n\nsystem_prompt\nAdditional system prompt to append to default system prompt.\n\n\nskills\nAdditional skills to make available to the agent.\n\n\nmcp_servers\nMCP servers (see MCP Servers below for details).\n\n\nbridged_tools\nHost-side Inspect tools to expose via MCP (see Bridged Tools below for details).\n\n\ndisallowed_tools\nOptionally disallow tools (e.g. \"WebSearch\")\n\n\ncentaur\nRun in Centaur Mode, which makes Claude Code available to an Inspect human_cli() agent rather than running it unattended.\n\n\nattempts\nAllow the agent to have multiple scored attempts at solving the task.\n\n\nmodel\nModel name to use for agent (defaults to main model for task).\n\n\nopus_model\nThe model to use for opus, or for opusplan when Plan Mode is active. Defaults to model.\n\n\nsonnet_model\nThe model to use for sonnet, or for opusplan when Plan Mode is not active. Defaults to model.\n\n\nhaiku_model\nThe model to use for haiku, or background functionality. Defaults to model.\n\n\nsubagent_model\nThe model to use for subagents. Defaults to model.\n\n\nfilter\nFilter for intercepting bridged model requests.\n\n\nretry_refusals\nShould refusals be retried? (pass number of times to retry)\n\n\nretry_timeouts\nShould timeouts be retried? (pass number of times to retry)\n\n\ncwd\nWorking directory for Claude Code session.\n\n\nenv\nEnvironment variables to set for Claude Code.\n\n\nversion\nVersion of Claude Code to use (see Installation below for details)\n\n\n\nFor example, here we specify a custom system prompt and disallow the WebSearch tool:\nclaude_code(\n    system_prompt=\"You are an ace system researcher.\",\n    disallowed_tools=[\"WebSearch\"]\n)",
    "crumbs": [
      "Home",
      "Agents",
      "Claude Code"
    ]
  },
  {
    "objectID": "claude_code.html#mcp-servers",
    "href": "claude_code.html#mcp-servers",
    "title": "Claude Code",
    "section": "MCP Servers",
    "text": "MCP Servers\nYou can specify one or more Model Context Protocol (MCP) servers to provide additional tools to Claude Code. Servers are specified via the MCPServerConfig class and its Stdio and HTTP variants.\nFor example, here is a Dockerfile that makes the server-memory MCP server available in the sandbox container:\nFROM python:3.12-bookworm\n\n# nodejs (required by mcp server)\nRUN apt-get update && apt-get install -y --no-install-recommends \\\n    curl \\\n    && curl -fsSL https://deb.nodesource.com/setup_22.x | bash - \\\n    && apt-get install -y --no-install-recommends nodejs \\\n    && apt-get clean \\\n    && rm -rf /var/lib/apt/lists/*\n\n# memory mcp server\nRUN npx --yes @modelcontextprotocol/server-memory --version\n\n# run forever\nCMD [\"tail\", \"-f\", \"/dev/null\"]\nNote that we run the npx server during the build of the Dockerfile so that it is cached for use offline (below we’ll run it with the --offline option).\nWe can then use this MCP server in a task as follows:\nfrom inspect_ai import Task, task\nfrom inspect_ai.dataset import Sample\nfrom inspect_ai.tool import MCPServerConfigStdio\nfrom inspect_swe import claude_code\n\n@task\ndef investigator() -&gt; Task:\n    return Task(\n        dataset=[\n            Sample(\n                input=\"What transport protocols are supported in \"\n                + \" the 2025-03-26 version of the MCP spec?\"\n            )\n        ],\n        solver=claude_code(\n            system_prompt=\"Please use the web search tool to \"\n            + \"research this question and the memory tools \"\n            + \"to keep track of your research.\",\n            mcp_servers=[\n                MCPServerConfigStdio(\n                    name=\"memory\",\n                    command=\"npx\",\n                    args=[\n                        \"--offline\",\n                        \"@modelcontextprotocol/server-memory\"\n                    ],\n                )\n            ]\n        ),\n        sandbox=(\"docker\", \"Dockerfile\"),\n    )\nNote that we run the MCP server using the --offline option so that it doesn’t require an internet connection (which it would normally use to check for updates to the package).",
    "crumbs": [
      "Home",
      "Agents",
      "Claude Code"
    ]
  },
  {
    "objectID": "claude_code.html#bridged-tools",
    "href": "claude_code.html#bridged-tools",
    "title": "Claude Code",
    "section": "Bridged Tools",
    "text": "Bridged Tools\nYou can expose host-side Inspect tools to the sandboxed agent via the MCP protocol using the bridged_tools parameter. This allows you to run tools on the host (e.g. tools that access host resources, databases, or APIs) but make them available to the agent running inside the sandbox.\nTools are specified via BridgedToolsSpec which wraps a list of Inspect tools:\nfrom inspect_ai import Task, task\nfrom inspect_ai.agent import BridgedToolsSpec\nfrom inspect_ai.dataset import Sample\nfrom inspect_ai.tool import tool\nfrom inspect_swe import claude_code\n\n@tool\ndef search_database():\n    async def execute(query: str) -&gt; str:\n        \"\"\"Search the internal database.\n\n        Args:\n            query: The search query.\n        \"\"\"\n        # This runs on the host, not in the sandbox\n        return f\"Results for: {query}\"\n    return execute\n\n@task\ndef investigator() -&gt; Task:\n    return Task(\n        dataset=[\n            Sample(input=\"Search for information about MCP protocols.\")\n        ],\n        solver=claude_code(\n            system_prompt=\"Use the search tool to research.\",\n            bridged_tools=[\n                BridgedToolsSpec(\n                    name=\"host_tools\",\n                    tools=[search_database()]\n                )\n            ]\n        ),\n        sandbox=(\"docker\", \"Dockerfile\"),\n    )\nThe name field identifies the MCP server and will be visible to the agent as a tool prefix. You can specify multiple BridgedToolsSpec instances to create separate MCP servers for different tool groups.\nSee the Bridged Tools documentation for more details on the architecture and how tool execution flows between host and sandbox.",
    "crumbs": [
      "Home",
      "Agents",
      "Claude Code"
    ]
  },
  {
    "objectID": "claude_code.html#installation-1",
    "href": "claude_code.html#installation-1",
    "title": "Claude Code",
    "section": "Installation",
    "text": "Installation\nBy default, the agent will download the current stable version of Claude Code and copy it to the sandbox. You can override this behaviour using the version option:\n\n\n\n\n\n\n\nOption\nDescription\n\n\n\n\n\"auto\"\nUse any available version of Claude Code in the sandbox, otherwise download the current stable version.\n\n\n\"sandbox\"\nUse the version of Claude Code in the sandbox (raises RuntimeError if not available in the sandbox)\n\n\n\"stable\"\nDownload and use the current stable version.\n\n\n\"latest\"\nDownload and use the very latest version.\n\n\n\"x.x.x\"\nDownload and use a specific version number.\n\n\n\nIf you don’t ever want to rely on automatic downloads of Claude Code (e.g. if you run your evaluations offline), you can use one of two approaches:\n\nPre-install the version of Claude Code you want to use in the sandbox, then use version=\"sandbox\":\nclaude_code(version=\"sandbox\")\nDownload the version of Claude Code you want to use into the cache, then specify that version explicitly:\n# download the agent binary during installation/configuration\ndownload_agent_binary(\"claude_code\", \"0.29.0\", \"linux-x64\")\n\n# reference that version in your task (no download will occur)\nclaude_code(version=\"0.29.0\")\nNote that the 5 most recently downloaded versions are retained in the cache. Use the cached_agent_binaries() function to list the contents of the cache.",
    "crumbs": [
      "Home",
      "Agents",
      "Claude Code"
    ]
  },
  {
    "objectID": "claude_code.html#centaur-mode",
    "href": "claude_code.html#centaur-mode",
    "title": "Claude Code",
    "section": "Centaur Mode",
    "text": "Centaur Mode\nThe claude_code() agent can also be run in “centaur” mode which uses the Inspect AI Human Agent as the solver and makes Claude Code available to the human user for help with the task. So rather than strictly measuring human vs. model performance, you are able to measure performance of humans working collaboratively with a model.\nEnable centaur mode by passing centaur=True to the claude_code() agent:\nfrom inspect_ai import Task, task\nfrom inspect_ai.dataset import json_dataset\nfrom inspect_ai.scorer import model_graded_qa\n\nfrom inspect_swe import claude_code\n\n@task\ndef system_explorer() -&gt; Task:\n    return Task(\n        dataset=json_dataset(\"dataset.json\"),\n        solver=claude_code(centaur=True),\n        scorer=model_graded_qa(),\n        sandbox=\"docker\",\n    )\nYou can also enable centaur mode from the CLI using a solver arg (-S):\ninspect eval ctf.py --solver inspect_swe/claude_code -S centaur=true\nYou can also pass CentaurOptions to further customize the behavior of the human agent. For example:\nfrom inspect_swe import CentaurOptions\n\nTask(\n    dataset=json_dataset(\"dataset.json\"),\n    solver=claude_code(centaur=CentaurOptions(answer=False)),\n    scorer=model_graded_qa(),\n    sandbox=\"docker\",\n)\nSee the human_cli() documentation for details on available options.",
    "crumbs": [
      "Home",
      "Agents",
      "Claude Code"
    ]
  },
  {
    "objectID": "claude_code.html#troubleshooting",
    "href": "claude_code.html#troubleshooting",
    "title": "Claude Code",
    "section": "Troubleshooting",
    "text": "Troubleshooting\nIf Claude Code doesn’t appear to be working or working as expected, you can troubleshoot by dumping the Claude Code debug log after an evaluation task is complete. You can do this with:\ninspect trace dump --filter \"Claude Code\"",
    "crumbs": [
      "Home",
      "Agents",
      "Claude Code"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Inspect SWE",
    "section": "",
    "text": "The inspect_swe package makes software engineering agents like Claude Code and Codex CLI available as standard Inspect agents. For example, here we use the claude_code() agent as the solver in an Inspect task:\nfrom inspect_ai import Task, task\nfrom inspect_ai.dataset import json_dataset\nfrom inspect_ai.scorer import model_graded_qa\n\nfrom inspect_swe import claude_code\n\n@task\ndef system_explorer() -&gt; Task:\n    return Task(\n        dataset=json_dataset(\"dataset.json\"),\n        solver=claude_code(),\n        scorer=model_graded_qa(),\n        sandbox=\"docker\",\n    )\nInspect SWE agents are implemented using the Inspect sandbox_agent_bridge().\nAgents run inside the sample sandbox and their model API calls are proxied back to Inspect. This means that you can use any model with Inspect SWE agents, and that features like token or time limits and log transcripts work as normal with the agents.",
    "crumbs": [
      "Home",
      "Getting Started"
    ]
  },
  {
    "objectID": "index.html#overview",
    "href": "index.html#overview",
    "title": "Inspect SWE",
    "section": "",
    "text": "The inspect_swe package makes software engineering agents like Claude Code and Codex CLI available as standard Inspect agents. For example, here we use the claude_code() agent as the solver in an Inspect task:\nfrom inspect_ai import Task, task\nfrom inspect_ai.dataset import json_dataset\nfrom inspect_ai.scorer import model_graded_qa\n\nfrom inspect_swe import claude_code\n\n@task\ndef system_explorer() -&gt; Task:\n    return Task(\n        dataset=json_dataset(\"dataset.json\"),\n        solver=claude_code(),\n        scorer=model_graded_qa(),\n        sandbox=\"docker\",\n    )\nInspect SWE agents are implemented using the Inspect sandbox_agent_bridge().\nAgents run inside the sample sandbox and their model API calls are proxied back to Inspect. This means that you can use any model with Inspect SWE agents, and that features like token or time limits and log transcripts work as normal with the agents.",
    "crumbs": [
      "Home",
      "Getting Started"
    ]
  },
  {
    "objectID": "index.html#getting-started",
    "href": "index.html#getting-started",
    "title": "Inspect SWE",
    "section": "Getting Started",
    "text": "Getting Started\nInstall Inspect SWE from PyPI with:\npip install inspect-swe\nThen, try out one or more of the available agents:\n\n\n\n\n\n\n\nAgent\nDescription\n\n\n\n\nclaude_code()\nAnthropic’s agentic coding tool Claude Code\n\n\ncodex_cli()\nOpenAI’s terminal-based coding agent Codex CLI",
    "crumbs": [
      "Home",
      "Getting Started"
    ]
  }
]